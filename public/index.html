<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link 
      href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&family=Playwrite+NO:wght@100..400&display=swap"
      rel="stylesheet"
      />
      <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Scrollable Main Page</title>
    <link rel="stylesheet" href="style.css">

    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href=
"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" />

    <!-- Bootstrap Font Icon CSS -->
    <link rel="stylesheet" href=
"https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.css" />

    <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@700&family=Vast+Shadow&display=swap" rel="stylesheet">
</head>
<body style=" background-color:#FFFDF5">
    <!-- Modal -->
    <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true" data-backdrop="false">
        <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content" style = 'text-align: center; width: 50%; right:-200px;'>
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">Favorites</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body" id="favorites-list">
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id = 'clear' style  = 'background-color: #93032E;'>clear</button>
                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id = 'close' >Close</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS and dependencies (Popper.js and jQuery) -->
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.4/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>


    <div class="overlay"></div>
    <div class="head-foot-container">
        <div class="header-container">
            <div>
                <a href="index.html">
                    <img
                    src="images/logo.svg"
                    alt="logo"
                    class="logo"
                    />
                </a>
            </div>
            <h1 class="title vast-shadow-regular" style="color: #3b871f; margin-left: 10px; margin-right: 50px; margin-top: 5px;">Crafty Corner</h1>
            <div class="search-bar">
                <input type="text" id = "textbox" placeholder="Search...">
                <button class="search-button">
                    <i class="fa-solid fa-magnifying-glass"></i>
                </button>
            </div>
            <div class="icons-container">
                <div style="margin-left: 100px; margin-right: 30px;">
                    <button type="button" data-toggle="modal" data-target="#exampleModal" style="border: none; background-color: #FFFDF5;">
                        <img
                            src="Images/favorites-icon.svg"
                            alt="favorites icon"
                            class="favorites-image"
                            data-image1="Images/favorites-icon.svg" 
                            data-image2="Images/favorites-click.svg"
                        />
                    </button>
                    
                </div>
                <div style="margin-right: 60px; margin-top: 10px;">
                    <a href="profile.html">
                        <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" fill="#3b871f" class="bi bi-person-circle button-hovered" viewBox="0 0 16 16">
                            <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0"/>
                            <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8m8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1"/>
                        </svg>
                    </a>
                </div>
            </div>
        </div>

        <div>
            <div style="position: fixed; bottom: 0; margin: 30px 40px;">
                <a href="messages.html">
                    <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" fill="#3b871f" class="bi bi-chat-left-dots-fill button-hovered" viewBox="0 0 16 16">
                        <path d="M0 2a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H4.414a1 1 0 0 0-.707.293L.854 15.146A.5.5 0 0 1 0 14.793zm5 4a1 1 0 1 0-2 0 1 1 0 0 0 2 0m4 0a1 1 0 1 0-2 0 1 1 0 0 0 2 0m3 1a1 1 0 1 0 0-2 1 1 0 0 0 0 2"/>
                    </svg>
                </a>
            </div>
            <div style="position: fixed; bottom: 0; right: 0; margin: 30px 60px;">
                <a href="addItem.html">
                    <svg xmlns="http://www.w3.org/2000/svg" width="60" height="60" fill="#3b871f" class="bi bi-plus-circle-fill button-hovered" viewBox="0 0 16 16">
                        <path d="M16 8A8 8 0 1 1 0 8a8 8 0 0 1 16 0M8.5 4.5a.5.5 0 0 0-1 0v3h-3a.5.5 0 0 0 0 1h3v3a.5.5 0 0 0 1 0v-3h3a.5.5 0 0 0 0-1h-3z"/>
                    </svg>
                </a>
            </div>
        </div>
    </div>
    

    <div class="container">
        <div class="labels">
            
            <div class="dropdown">
                <button id="color" class="orange label" onclick="drop('color', 'color-dropdown', 'color-caret')">
                    Color
                    <i id="color-caret" class="bi bi-caret-down-fill"></i>
                </button>
                <div id="color-dropdown" class="dropdown-content">
                    <!-- add colors based on database -->
                </div>
            </div>

            <div class="dropdown">
                <button id="quantity" class="green label" onclick="drop('quantity', 'quantity-dropdown', 'quantity-caret')">
                    Quantity
                    <i id="quantity-caret" class="bi bi-caret-down-fill"></i>
                </button>
                <div id="quantity-dropdown" class="dropdown-content">
                    <!-- add quantity based on database-->
                </div>
            </div>

            <div class="dropdown">
                <button id="condition" class="lightblue label" onclick="drop('condition', 'condition-dropdown', 'condition-caret')">
                    Condition
                    <i id="condition-caret" class="bi bi-caret-down-fill"></i>
                     
                </button>
                <div id="condition-dropdown" class="dropdown-content">
                     <!-- add condition based on database-->
                </div>
            </div>

            <div class="dropdown">
                <button id="price" class="pink label" onclick="drop('price', 'price-dropdown', 'price-caret')">
                    Price
                    <i id="price-caret" class="bi bi-caret-down-fill"></i>
                </button>
                <div id="price-dropdown" class="dropdown-content">
                     <!-- add price based on database-->
                </div>
            </div>

            <div class="dropdown">
                <button id="material" class="blue label" onclick="drop('material', 'material-dropdown', 'material-caret')">
                    Material
                    <i id="material-caret" class="bi bi-caret-down-fill"></i>
                </button>
                <div id="material-dropdown" class="dropdown-content">
                     <!-- add material based on database-->
                </div>
            </div>
            
        </div>
        
        <div class="grid" id = "items-grid">
            <!-- this is where the displayItems does its magic -->
        </div>
    </div>
    <div class="side-panel">
        <button class="side-panel-close" type="button">Ã—</button>
        <h2 class="side-title">Side Panel</h2>
        <img src="images/content-images/glue.jpg" alt="Image" id="image-id">
        <div class="box-icons">
            
        </div>
        <p class="side-panel-content">Select a box to see its description.</p>
        <div class="side-panel-labels"></div>
        <a href="messages.html">
            <button style="position: absolute; bottom: 0; margin: 20px 60px; border: none; background-color: #3b871f; border-radius: 20px; color: white; padding: 5px 10px;">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-chat-right-dots" viewBox="0 0 16 16">
                    <path d="M2 1a1 1 0 0 0-1 1v8a1 1 0 0 0 1 1h9.586a2 2 0 0 1 1.414.586l2 2V2a1 1 0 0 0-1-1zm12-1a2 2 0 0 1 2 2v12.793a.5.5 0 0 1-.854.353l-2.853-2.853a1 1 0 0 0-.707-.293H2a2 2 0 0 1-2-2V2a2 2 0 0 1 2-2z"/>
                    <path d="M5 6a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0m4 0a1 1 0 1 1-2 0 1 1 0 0 1 2 0"/>
                </svg>
                Message Seller
            </button>
        </a>
    </div>

    <script>
        function drop(buttonId, dropdownId, caretId) {
            console.log('drop called');
            var button = document.getElementById(buttonId);
            var dropdown = document.getElementById(dropdownId);
            var caret = document.getElementById(caretId);
            var buttonWidth = window.getComputedStyle(button).width;

            const allDropdowns = document.querySelectorAll('.dropdown-content');
            const allButtons = document.querySelectorAll('.label');
            const allCarets = document.querySelectorAll('.bi-caret-up-fill, .bi-caret-down-fill');


            allDropdowns.forEach(dd => {
                if (dd !== dropdown) {
                    dd.style.display = 'none';
                }
            });
            if (dropdown.style.display === "none" || dropdown.style.display === "") {
                // Open the dropdown
                button.style.borderBottomLeftRadius = "0";
                button.style.borderBottomRightRadius = "0";
                dropdown.style.display = "block";
                dropdown.style.width = buttonWidth;
                caret.classList.remove("bi-caret-down-fill");
                caret.classList.add("bi-caret-up-fill");
            } else {
                // Close the dropdown
                button.style.borderBottomLeftRadius = "12px";
                button.style.borderBottomRightRadius = "12px";
                dropdown.style.display = "none";
                caret.classList.remove("bi-caret-up-fill");
                caret.classList.add("bi-caret-down-fill");
            }
    }

        
        //adds the relevant items into the grid. 
        let itemsArray = [];
        document.addEventListener('DOMContentLoaded', async() =>  {
            const response = await fetch('database.json');
            const items = await response.json();
            const itemsGrid = document.getElementById("items-grid");
            itemsArray = Object.values(items);
            var favsList = JSON.parse(localStorage.getItem('favorites')) || [];
            if (!Array.isArray(favsList)) {
                console.warn('Data from localStorage is not an array. Initializing as an empty array.');
                favsList = [];
            }
            console.log('Initial favsList:', favsList);

            //display the items (boxes)
            console.log("displaying all items:", itemsGrid);
            displayItems(items);
            getLabels(items);
            filter(items);
            
            

            // function that displays the items
            function displayItems(displayItems) {
                const itemsGrid = document.getElementById('items-grid');
                const errorMessage = document.getElementById('error');
                itemsGrid.innerHTML = '';

                for (var key in displayItems) {
                    // hasOwnProperty checks if the json object has filtered property, key. Key can be like the ID or it can be some logic
                    if (displayItems.hasOwnProperty(key)) {
                        const item = displayItems[key];
                        const itemBox = document.createElement('div');
                        itemBox.className = 'box';
                        itemBox.innerHTML =  `
                        <div class="top-half">
            <img src="${item.ImageURL}" alt="Image of ${item.Name}" class="round-top-corners">
        </div>
        <div class="bottom-half">
            <div class="box-title"> 
                <button class="favorite-button">
                    <img src="Images/star.svg" alt="favorites star" class="favorites-star" data-name="${item.Name}" style="margin-bottom:20px">
                </button>
                ${item.Name} 
            </div>
            <div class="box-icons">
                ${item.EcoFriendly && item.Barter ? `
                    <div>
                        <img src="Images/eco-icon2.svg" alt="eco friendly symbol" class="post-icon">
                        <img src="Images/barter-icon.svg" alt="barter symbol" class="post-icon">
                    </div>` 
                : item.EcoFriendly ? `
                    <div>
                        <img src="Images/eco-icon2.svg" alt="eco friendly symbol" class="post-icon">
                    </div>` 
                : item.Barter ? `
                    <div>
                        <img src="Images/barter-icon.svg" alt="barter symbol" class="post-icon">
                    </div>` 
                : ''}
            </div>
            <div class="box-description"> ${item.Description}  </div>
    `; 
                        itemBox.innerHTML += ` 
                            <div class="display-tag">
                                    <div  class = "pink display-tag-item">  ${item.Labels.Price} </div>
                                    <div class = "blue display-tag-item">  ${item.Labels.Material}</div>
                                    <div class = "green display-tag-item">  ${item.Labels.Quantity}</div>
                                    <div class = "orange display-tag-item">  ${item.Labels.Color}</div>
                                    <div class = "lightblue display-tag-item">  ${item.Labels.Condition}</div>
                            </div>
                            </div>
                           
                        `;
                        itemsGrid.appendChild(itemBox);
                    }
                    
                }

                addFavoritesListener();
                //if side panel is clicked closed
                const boxes = document.querySelectorAll('.box');
                boxes.forEach(box => {
                    box.addEventListener('click', (event) => {
                        if (!event.target.closest('.favorite-button')) {
                            const title = box.querySelector('.box-title').textContent;
                            const description = box.querySelector('.box-description').textContent;
                            const imageSrc = box.querySelector('img').src;
                            const displayTags = box.querySelector('.display-tag').innerHTML; // Specific display-tag for this box

                            document.querySelector(".side-title").textContent = title;
                            document.querySelector(".side-panel-content").textContent = description;
                            document.querySelector("#image-id").src = imageSrc;
                            document.querySelector('.side-panel-labels').innerHTML = displayTags;

                            document.querySelector(".side-panel").classList.toggle("side-panel-open");
                            document.querySelector(".overlay").classList.add("overlay-active");
                        }
                    });
                });

                document.querySelector(".side-panel-close").addEventListener("click", () => {
                    document.querySelector(".side-panel").classList.remove("side-panel-open");
                    document.querySelector(".overlay").classList.remove("overlay-active");
                });
            }
            
            var favoritesList = document.getElementById('favorites-list');

        // Retrieve favorites from localStorage or initialize as an empty array
        

        function addFavoritesListener() {
            const favoriteButtons = document.querySelectorAll('.favorite-button');
            favoriteButtons.forEach(button => {
                const star = button.querySelector('.favorites-star');
            if (!star) {
                console.error('Star element not found within button:', button);
                return;
            }

            const itemName = star.getAttribute('data-name');
            if (!itemName) {
                console.error('data-name attribute not found on star element:', star);
                return;
            }

            // Debugging output to check itemName and favsList
            console.log('itemName:', itemName);
            console.log('favsList:', favsList);
                
                // Set initial state of the star image based on favsList
                if (favsList.includes(itemName)) {
                    star.src = 'Images/star-fill.svg'; // Filled star
                } else {
                    star.src = 'Images/star.svg'; // Unfilled star
                }
                button.addEventListener('click', () => {
                    
                    if (favsList.includes(itemName)) {
                        // Removing the item from the list
                        favsList = favsList.filter(favorite => favorite !== itemName);
                        button.querySelector('.favorites-star').src = 'Images/star.svg'; // Unfilled star
                    } else {
                        // Adding the item to the list
                        favsList.push(itemName);
                        button.querySelector('.favorites-star').src = 'Images/star-fill.svg'; // Filled star
                    }
                    
                    updateFavoritesList();
                });
            });
        }
        function updateFavoritesList() {
            // Update localStorage with the current list
            localStorage.setItem('favorites', JSON.stringify(favsList));
            // Reload the list to reflect changes
            reloadFavoritesList();
            console.log('Updated favorites list:', favsList);
        }

        function reloadFavoritesList() {
                const favoritesList = document.getElementById('favorites-list');
                // const noFavorites = document.getElementById('no-favorites');
                favoritesList.innerHTML = '';
                if (favsList.length === 0) {
                    favoritesList.textContent = 'No favorites!';
        }else{
            favsList.forEach(favorite => {
                    const favoriteItem = document.createElement('p');
                    favoriteItem.textContent = favorite;
                    favoriteItem.classList.add('favorite-item');
                    favoriteItem.setAttribute('data-name', favorite);
                    favoritesList.appendChild(favoriteItem);
                });
        }
                
                addFavoriteItemClickListeners();
            }
        function addFavoriteItemClickListeners() {
            const favoriteItems = document.querySelectorAll('.favorite-item');
            favoriteItems.forEach(item => {
                item.addEventListener('click', () => {
                    const itemName = item.getAttribute('data-name');
                    const itemData = itemsArray.find(it => it.Name === itemName);
                    if (itemData) {
                        openSidePanel(itemData);
                    }
                });
            });
        }
        function updateStarImages() {
                const favoriteButtons = document.querySelectorAll('.favorite-button');
                favoriteButtons.forEach(button => {
                    const star = button.querySelector('.favorites-star');
                    if (!star) return;

                    const itemName = star.getAttribute('data-name');
                    if (favsList.includes(itemName)) {
                        star.src = 'Images/star-fill.svg'; // Filled star
                    } else {
                        star.src = 'Images/star.svg'; // Unfilled star
                    }
                });
            }
        function openSidePanel(item) {
                document.querySelector(".side-title").textContent = item.Name;
                document.querySelector(".side-panel-content").textContent = item.Description;
                document.querySelector("#image-id").src = item.ImageURL;
                document.querySelector('.side-panel-labels').innerHTML = `
                    <div class="pink display-tag-item">${item.Labels.Price}</div>
                    <div class="blue display-tag-item">${item.Labels.Material}</div>
                    <div class="green display-tag-item">${item.Labels.Quantity}</div>
                    <div class="orange display-tag-item">${item.Labels.Color}</div>
                    <div class="lightblue display-tag-item">${item.Labels.Condition}</div>
                `;

                document.querySelector(".side-panel").classList.add("side-panel-open");
                document.querySelector(".overlay").classList.add("overlay-active");
            }
            function addSidePanelListeners() {
                const boxes = document.querySelectorAll('.box');
                boxes.forEach(box => {
                    box.addEventListener('click', (event) => {
                        if (!event.target.closest('.favorite-button')) {
                            const title = box.querySelector('.box-title').textContent;
                            const description = box.querySelector('.box-description').textContent;
                            const imageSrc = box.querySelector('img').src;
                            const displayTags = box.querySelector('.display-tag').innerHTML;

                            document.querySelector(".side-title").textContent = title;
                            document.querySelector(".side-panel-content").textContent = description;
                            document.querySelector("#image-id").src = imageSrc;
                            document.querySelector('.side-panel-labels').innerHTML = displayTags;

                            document.querySelector(".side-panel").classList.add("side-panel-open");
                            document.querySelector(".overlay").classList.add("overlay-active");
                        }
                    });
                });

                document.querySelector(".side-panel-close").addEventListener("click", () => {
                    document.querySelector(".side-panel").classList.remove("side-panel-open");
                    document.querySelector(".overlay").classList.remove("overlay-active");
                });
            }

        window.onload = () => {
            reloadFavoritesList();
            addFavoritesListener(); // Ensure buttons have event listeners
        };
        // Clear Favorites Function
        function clearFavorites() {
                favsList = [];
                localStorage.setItem('favorites', JSON.stringify(favsList));
                reloadFavoritesList();
                updateStarImages();
            }

            // Add Event Listener to Clear Favorites Button
            document.getElementById('clear').addEventListener('click', clearFavorites);

            // Load favorites on page load
        reloadFavoritesList();
            function getLabels(itemsGrid) {
                const colorDropdown = document.getElementById("color-dropdown");
                const quantityDropdown = document.getElementById("quantity-dropdown");
                const conditionDropdown = document.getElementById("condition-dropdown");
                const priceDropdown = document.getElementById("price-dropdown");
                const materialDropdown = document.getElementById("material-dropdown");

                let colorLabels = [];
                let quantityLabels = [];
                let conditionLabels = [];
                let priceLabels = [];
                let materialLabels = [];
                
                for (key in items) {
                    const item = items[key];
                    if (!colorLabels.includes(item.Labels.Color)) {
                        colorLabels.push(item.Labels.Color);
                        colorDropdown.innerHTML += `<div class="orange dropdown-label" data-color="${item.Labels.Color}">${item.Labels.Color}</div>`;
                    }

                    //quantity labels: 
                    if (!quantityLabels.includes(item.Labels.Quantity)) {
                        quantityLabels.push(item.Labels.Quantity); // use push which modifies existing..+= returns new array
                        quantityDropdown.innerHTML += `<div class="green dropdown-label" data-quantity="${item.Labels.Quantity}">${item.Labels.Quantity}</div>`;
                    }

                    if (!conditionLabels.includes(item.Labels.Condition)) {
                        conditionLabels.push(item.Labels.Condition);
                        conditionDropdown.innerHTML += `<div class="lightblue dropdown-label" data-condition="${item.Labels.Condition}">${item.Labels.Condition}</div>`;
                    }
                    if (!priceLabels.includes(item.Labels.Price)) {
                        priceLabels.push(item.Labels.Price);
                        priceDropdown.innerHTML += `<div class="pink dropdown-label" data-price="${item.Labels.Price}">${item.Labels.Price}</div>`;
                    }
                    // Populate Material Labels
                    if (!materialLabels.includes(item.Labels.Material)) {
                        materialLabels.push(item.Labels.Material);
                        materialDropdown.innerHTML += `<div class="blue dropdown-label" data-material="${item.Labels.Material}">${item.Labels.Material}</div>`;
                    }

                }

            }
            function filter(items){
                // filter by Color
                const colorLabels = document.querySelectorAll('.dropdown-label[data-color]');
                colorLabels.forEach(label => {
                    label.addEventListener('click', () => {
                        const selectedCondition = label.getAttribute('data-color');
                        const filtered = {};

                        for (var key in items) {
                            if (items.hasOwnProperty(key) && items[key].Labels.Color === selectedCondition) {
                                filtered[key] = items[key];
                            }
                        }
                        displayItems(filtered);
                    });
                });
                //filter by Quantity
                const quantityLabels = document.querySelectorAll('.dropdown-label[data-quantity]');
                quantityLabels.forEach(label => {
                    label.addEventListener('click', () => {
                        const selectedCondition = label.getAttribute('data-quantity');
                        const filtered = {};

                        for (var key in items) {
                            if (items.hasOwnProperty(key) && items[key].Labels.Quantity === selectedCondition) {
                                filtered[key] = items[key];
                            }
                        }
                        displayItems(filtered);
                    });
                });

                //Event Listener for the Condition Filter: 
                const conditionLabels = document.querySelectorAll('.dropdown-label[data-condition]');
                conditionLabels.forEach(label => {
                    label.addEventListener('click', () => {
                        const selectedCondition = label.getAttribute('data-condition');
                        const filtered = {};

                        for (var key in items) {
                            if (items.hasOwnProperty(key) && items[key].Labels.Condition === selectedCondition) {
                                filtered[key] = items[key];
                            }
                        }
                        displayItems(filtered);
                    });
                });
                //filter by Price
                const priceLabels = document.querySelectorAll('.dropdown-label[data-price]');
                priceLabels.forEach(label => {
                    label.addEventListener('click', () => {
                        const selectedCondition = label.getAttribute('data-price');
                        const filtered = {};

                        for (var key in items) {
                            if (items.hasOwnProperty(key) && items[key].Labels.Price === selectedCondition) {
                                filtered[key] = items[key];
                            }
                        }
                        displayItems(filtered);
                    });
                });

                //filter by Material
                const materialLabels = document.querySelectorAll('.dropdown-label[data-material]');
                materialLabels.forEach(label => {
                    label.addEventListener('click', () => {
                        const selectedCondition = label.getAttribute('data-material');
                        const filtered = {};

                        for (var key in items) {
                            if (items.hasOwnProperty(key) && items[key].Labels.Material === selectedCondition) {
                                filtered[key] = items[key];
                            }
                        }
                        displayItems(filtered);
                    });
                });

                }
            //go through search response
            
            const searchButton = document.querySelector('.search-button');
            searchButton.addEventListener("click", async() => {
                
                const searchQuery = document.getElementById('textbox').value.toLowerCase();
                console.log('searchQuery is: ', searchQuery);

                const response = await fetch('database.json');
                const json = await response.json();
                console.log("json file is: " , json);
                const filtered = {};

                for (var key in json) {
                    if (json.hasOwnProperty(key) && json[key] && typeof json[key].Name === 'string' && json[key].Name.toLowerCase().includes(searchQuery)) {
                        console.log('filtering...', json[key]);
                        filtered[key] = json[key];
                        console.log('current items', filtered)
                    }       
                }
                displayItems(filtered);
                console.log('filtered items', filtered)
                 //give error if there are no relevant results.
                 if (Object.keys(filtered).length == 0) {
                    alert("I'm sorry, we are unable to find items related to your search.");
                    displayItems(items); // reset to home
                }
               
            });
            
            
            const textInput = document.getElementById('textbox');
            textInput.addEventListener('keydown', async(event) => {
            if (event.key === 'Enter') {
                const searchQuery = document.getElementById('textbox').value.toLowerCase();
                // console.log('searchQuery is: ', searchQuery);

                const response = await fetch('database.json');
                const json = await response.json();
                // console.log("json file is: " , json);
                const filtered = {};

                for (var key in json) {
                    if (json.hasOwnProperty(key) && json[key] && typeof json[key].Name === 'string' && json[key].Name.toLowerCase().includes(searchQuery)) {
                        console.log('filtering...', json[key]);
                        filtered[key] = json[key];
                        console.log('current items', filtered)
                    }       
                }
                displayItems(filtered);
                console.log('filtered items', filtered)
                 //give error if there are no relevant results.
                 if (Object.keys(filtered).length == 0) {
                    alert("I'm sorry, we are unable to find items related to your search.");
                    displayItems(items); // reset to home
                }
            
            }
            });
            const favIcon = document.querySelector('.favorites-image');
            favIcon.addEventListener('click', () => {
                const currentSrc = favIcon.src.split('/').pop(); // Extract file name from src
                const image1 = favIcon.getAttribute('data-image1').split('/').pop();
                const image2 = favIcon.getAttribute('data-image2').split('/').pop();

                if (currentSrc === image1) {
                    favIcon.src = favIcon.getAttribute('data-image2'); // Swap to second image
                } else {
                    favIcon.src = favIcon.getAttribute('data-image1'); // Swap back to initial image
                }

            });
            $('#exampleModal').on('hidden.bs.modal', function () {
                    favIcon.src = favIcon.getAttribute('data-image1'); // Reset to the initial image
                });
            
            
        });
    
    </script>

   
</body>
</html>